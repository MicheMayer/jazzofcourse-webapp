---
import type { DefaultComponentProps } from '@models'
import type { CollectionEntry } from 'astro:content'
import { getEntry } from 'astro:content'
import * as styles from './EventItem.css'
import instruments from '@assets/logos/band/instruments.svg'
import Heading from '@components/typography/Heading.astro'

interface Props extends DefaultComponentProps {
  event: CollectionEntry<'events'>['data']
}

const { event } = Astro.props

var location =
  event.location?.id &&
  (await getEntry('locations', event.location.id)).data.name
---

<div class:list={styles.eventItem}>
  <img
    class={styles.heroImage}
    src={event.heroImage?.src ?? instruments.src}
    alt={event.title}
  />
  <div class={styles.content}>
    <Heading level="4" isCapitalized={true}>{event.title}</Heading>
    <div>
      {event.description}
    </div>
    <time>{event.date.toLocaleDateString('de-de')}</time>
    <time>{event.date.toLocaleTimeString('de-de', {hour: '2-digit', minute:'2-digit'})} Uhr</time>
    {location && <div>{location}</div>}
  </div>
</div>
